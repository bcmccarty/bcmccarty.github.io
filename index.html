<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Magic Penny</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'DM Sans', system-ui, sans-serif;
            min-height: 100vh;
            background: #fffdf8;
            color: #1a1a1a;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px 60px;
        }

        h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: #1a1a1a;
        }

        .tagline {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .day {
            font-size: 1.1rem;
            color: #888;
            margin-bottom: 4px;
        }

        .day strong {
            color: #1a1a1a;
            font-size: 1.3rem;
        }

        .money {
            font-size: 3rem;
            font-weight: 700;
            color: #16a34a;
            margin: 8px 0 20px;
            transition: transform 0.15s ease;
        }

        .money.pop {
            transform: scale(1.08);
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06), 0 0 0 1px rgba(0,0,0,0.04);
            max-width: 340px;
            width: 100%;
            margin-bottom: 24px;
        }

        .image-wrap {
            width: 200px;
            height: 200px;
            margin: 0 auto 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-wrap img {
            max-width: 100%;
            max-height: 100%;
            border-radius: 8px;
        }

        .description {
            font-size: 1rem;
            line-height: 1.5;
            color: #444;
            min-height: 72px;
        }

        .buttons {
            display: flex;
            gap: 12px;
            max-width: 340px;
            width: 100%;
        }

        button {
            flex: 1;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.1s ease, box-shadow 0.1s ease;
        }

        button:active {
            transform: scale(0.97);
        }

        .btn-double {
            background: #16a34a;
            color: white;
        }

        .btn-double:hover {
            background: #15803d;
        }

        .btn-back {
            background: #f1f1f1;
            color: #666;
            flex: 0 0 auto;
            padding: 14px 18px;
        }

        .btn-back:hover:not(:disabled) {
            background: #e5e5e5;
            color: #333;
        }

        .btn-back:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .slider-section {
            max-width: 340px;
            width: 100%;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid #eee;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 10px;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e5e5e5;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #16a34a;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(22, 163, 74, 0.3);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #16a34a;
            cursor: pointer;
            border: none;
        }

        .milestone {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: white;
            padding: 32px 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: transform 0.25s ease, opacity 0.25s ease;
        }

        .milestone.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            pointer-events: auto;
        }

        .milestone h2 {
            font-size: 1.6rem;
            margin-bottom: 8px;
        }

        .milestone p {
            color: #666;
            font-size: 1rem;
        }

        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.3);
            z-index: 99;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease;
        }

        .overlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        .reset-link {
            margin-top: 24px;
            font-size: 0.85rem;
            color: #999;
            text-decoration: underline;
            cursor: pointer;
            background: none;
            border: none;
            font-family: inherit;
        }

        .reset-link:hover {
            color: #666;
        }

        /* Preload images container - hidden */
        .preload {
            position: absolute;
            width: 1px;
            height: 1px;
            overflow: hidden;
            opacity: 0;
            pointer-events: none;
        }

        @media (max-width: 400px) {
            h1 { font-size: 2.2rem; }
            .money { font-size: 2.4rem; }
            body { padding: 24px 16px 40px; }
        }
    </style>
</head>
<body>
    <h1>The Magic Penny</h1>
    <p class="tagline">Double your money every day</p>

    <p class="day">Day <strong id="day-num">0</strong></p>
    <p class="money" id="money">$0.01</p>

    <div class="card">
        <div class="image-wrap">
            <img id="img" src="" alt="">
        </div>
        <p class="description" id="desc"></p>
    </div>

    <div class="buttons">
        <button class="btn-back" id="back-btn" onclick="goBack()" disabled>Back</button>
        <button class="btn-double" onclick="doubleMoney()">Double it</button>
    </div>

    <div class="slider-section">
        <div class="slider-label">
            <span>Jump to day</span>
            <span id="slider-val">0</span>
        </div>
        <input type="range" id="slider" min="0" max="55" value="0" oninput="jumpTo(this.value)">
    </div>

    <button class="reset-link" onclick="reset()">Start over</button>

    <div class="overlay" id="overlay" onclick="closeMilestone()"></div>
    <div class="milestone" id="milestone">
        <h2 id="m-title"></h2>
        <p id="m-text"></p>
    </div>

    <!-- Hidden preload container -->
    <div class="preload" id="preload"></div>

    <script>
        let day = 0;
        let money = 0.01;
        const maxDay = 55;
        const imageCache = {};

        const items = [
            'One penny. Watch it grow.',
            'A paperclip.',
            'A Dum Dum lollipop.',
            'A Lego minifigure head.',
            '1 kilowatt-hour of electricity.',
            'A packet of Kool-Aid.',
            'A carpenter\'s pencil.',
            'An old-fashioned donut.',
            'A McDonald\'s sundae.',
            'A deck of playing cards.',
            'A bag of coffee.',
            'The Lord of the Rings trilogy (paperback).',
            'A flight from London to Athens.',
            'A Japanese chef knife.',
            'An oil change for a BMW M3.',
            'Noise-canceling headphones.',
            'Front-row MLS tickets.',
            'One month of rent (US average).',
            'An electric bike.',
            'A night at the Ritz-Carlton NYC.',
            'A luxury refrigerator.',
            'A bottle of ultra-rare wine.',
            'A Toyota Tundra.',
            'A private jet flight to NYC.',
            'A monster truck.',
            'A house in the Midwest.',
            'A 10kg gold bar.',
            'A private Paul McCartney concert.',
            'A Patek Philippe watch.',
            '44,784 years of Spotify Premium.',
            'A small Caribbean island.',
            '200 years of Michelin dining.',
            'A mansion.',
            'A hospital wing (with your name on it).',
            'A Boeing 737.',
            'A mega yacht.',
            '0.1% of Tesla.',
            'An NHL team.',
            'An NBA team.',
            '289 lunches with Warren Buffett.',
            'Reddit.',
            'An international airport.',
            'Twitter.',
            'Every NBA team.',
            '10% of US annual revenue.',
            '$1,000 for every American.',
            'All US university endowments.',
            'The entire crypto market.',
            'The French economy.',
            'Apple, Microsoft, and Amazon.',
            'All the gold ever mined.',
            'The US money supply.',
            'The entire US stock market.',
            '750 billion years of Costco membership.',
            '50 years of global military spending.',
            'The entire world.'
        ];

        const images = [];
        for (let i = 0; i <= 55; i++) {
            if (i === 0) images.push('images/penny_day0.png');
            else images.push(`images/day${i}.png`);
        }
        images.push('images/moneyprinter.gif');

        const milestones = {
            7: ['You have a dollar!', 'It only took a week.'],
            14: ['$100!', 'Now we\'re getting somewhere.'],
            20: ['$10,000!', 'That escalated quickly.'],
            27: ['You\'re a millionaire!', 'Took less than a month.'],
            37: ['Billionaire!', 'With a B.'],
            47: ['Trillionaire!', 'This is getting ridiculous.'],
            55: ['You own the world.', 'Now what?']
        };

        function formatMoney(n) {
            if (n >= 1e12) return '$' + (n / 1e12).toFixed(1) + ' trillion';
            if (n >= 1e9) return '$' + (n / 1e9).toFixed(1) + ' billion';
            if (n >= 1e6) return '$' + (n / 1e6).toFixed(1) + ' million';
            if (n >= 1000) return '$' + n.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            return '$' + n.toFixed(2);
        }

        function preloadImages(startDay, count) {
            for (let i = startDay; i < Math.min(startDay + count, images.length); i++) {
                if (!imageCache[i]) {
                    const img = new Image();
                    img.src = images[i];
                    imageCache[i] = img;
                }
            }
        }

        function update() {
            const moneyEl = document.getElementById('money');
            moneyEl.textContent = formatMoney(money);
            moneyEl.classList.add('pop');
            setTimeout(() => moneyEl.classList.remove('pop'), 150);

            document.getElementById('day-num').textContent = day;
            document.getElementById('slider').value = day;
            document.getElementById('slider-val').textContent = day;
            document.getElementById('back-btn').disabled = day === 0;

            const img = document.getElementById('img');
            const src = day < images.length - 1 ? images[day] : images[images.length - 1];
            img.src = src;

            document.getElementById('desc').textContent = day < items.length ? items[day] : 'Beyond comprehension.';

            // Preload next 5 images
            preloadImages(day + 1, 5);
        }

        function doubleMoney() {
            if (day >= maxDay) return;
            const prev = day;
            day++;
            money = 0.01 * Math.pow(2, day);
            update();
            if (milestones[day]) showMilestone(milestones[day][0], milestones[day][1]);
        }

        function goBack() {
            if (day === 0) return;
            day--;
            money = 0.01 * Math.pow(2, day);
            update();
        }

        function jumpTo(d) {
            day = parseInt(d);
            money = 0.01 * Math.pow(2, day);
            update();
        }

        function reset() {
            day = 0;
            money = 0.01;
            update();
        }

        function showMilestone(title, text) {
            document.getElementById('m-title').textContent = title;
            document.getElementById('m-text').textContent = text;
            document.getElementById('overlay').classList.add('show');
            document.getElementById('milestone').classList.add('show');
        }

        function closeMilestone() {
            document.getElementById('overlay').classList.remove('show');
            document.getElementById('milestone').classList.remove('show');
        }

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') doubleMoney();
            if (e.key === 'ArrowLeft') goBack();
            if (e.key === 'Escape') closeMilestone();
        });

        // Prevent double-tap zoom on mobile
        let lastTap = 0;
        document.addEventListener('touchend', (e) => {
            const now = Date.now();
            if (now - lastTap < 300) e.preventDefault();
            lastTap = now;
        }, { passive: false });

        // Init
        preloadImages(0, 10);
        update();
    </script>
</body>
</html>
